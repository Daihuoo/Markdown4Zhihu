# 常微分方程笔记（一）

为了应对下一学期《数学物理方法》课程的学习，回顾常微分方程相关的内容，主要是以“解”方程为主。参考书籍主要是《大学数学教程》（第二册）以及《高等数学》（仇庆久版）。

### $\S$1 基本概念

* 微分方程：指包含**自变量**，**未知函数**及**其导数**（或微分）的方程。
  常微分方程：**自变量个数为1**的微分方程。
* 微分方程的**阶**：指的是未知函数导数的最高阶。
* 若未知函数与其导数的次数都为1，则称为**线性微分方程**。
* 满足微分方程的函数称为**解**，包含==独立任意常数的个数与方程阶数相同==的解叫做**通解**，不含任意常数的解称为**特解**。
  特解的几何图形对应于一条平面曲线，叫做**积分曲线**；通解则对应于一族曲线，叫做**积分曲线族**。
* 确认任意常数的条件叫做定解条件。特别的，定解条件为初始时刻条件的又称作初始条件或初值条件。而如果定解条件给出自变量所在区间的端点的条件，则称为边界条件。

### $\S$2 简单常微分方程的解法

#### $\S$2.1 可分离变量的一阶方程

* 形如
  $$
  \frac{dy}{dx}=f(x)g(y)
  \tag{1}
  $$
  的微分方程称为可分离变量的一阶微分方程。如果$g(y) \neq 0$，那么可以改写为
  $$
  \frac{dy}{g(y)}=f(x)dx
  \tag{2}
  $$
  从而两侧同时积分可得通解
  $$
  \int \frac{dy}{g(y)} = \int f(x)dx + C
  \tag{3}
  $$
  
* 如果$g(y)=0$，设实根为$y_0$，显然满足微分方程，即是特解。但这个解一般在分离变量的时候会丢失，有可能不包含在通解的表达式中。因此解答问题的时候，**需要分$g(y)$是否为0进行讨论**。

* 有些微分方程，经过一些**适当的变形**后，可以化为可分离变量的方程。下面简单介绍几种

  1. 
     $$
     \frac{dy}{dx}=f(ax+by+c)
     \tag{4}
     $$
     作代换$z(x)=ax+by(x)+c$，可以化简为
     $$
     \frac{dz}{dx}=a+b\frac{dy}{dx}=a+bf(z)
     \tag{5}
     $$

  2. 齐次方程
     $$
     \frac{dy}{dx}=g(\frac{y}{x})
     \tag{6}
     $$
     同样可以作代换$u=\frac{y}{x}$，可以转化为
     $$
     u+x\frac{u}{x}=g(u)
     \tag{7}
     $$

  3. 形如
     $$
     \frac{dy}{dx}=f(\frac{a_1 x+b_1 y +c_1}{a_2x+b_2y+c_2}),\Delta=\begin{vmatrix}
     a_1 & b_1 \\
     a_2 & b_2 
     \end{vmatrix} \neq 0
     \tag{8}
     $$
     因为$\Delta\neq0$，所以方程组
     $$
     \begin{cases}
     a_1x+b_1y+c_1=0 \\
     a_2x+b_2y+c_2=0
     \end{cases}
     \tag{9}
     $$
     有唯一解$(x_0,y_0)$，可以作平移变换以消去常数项$c_1,c_2$
     $$
     \begin{cases}
     x=\xi +x_0 \\
     y=\eta +y_0
     \end{cases}
     \tag{10}
     $$
     从而方程可以化为齐次方程
     $$
     \frac{d\eta}{d\xi}=f(\frac{a_1\xi+b_1\eta}{a_2\xi+b_2\eta})
     \tag{11}
     $$
     就转换为了2对应的情形。

#### $\S$2.2 一阶线性方程

* ==一阶线性方程的标准形式==为
  $$
  \frac{dy}{dx}+P(x)y=Q(x)
  \tag{12}
  $$
  其中要求P，Q两个函数均是连续函数。如果$Q(x)\equiv 0$，那么方程变为==一阶线性齐次方程==
  $$
  \frac{dy}{dx}+P(x)y = 0
  \tag{13}
  $$

* 先解齐次方程（13），采用分离变量法，**积分取对数**可得
  $$
  y=C_0 e^{-\int P(x)dx}
  \tag{14}
  $$
  注意这里的特解$y=0$已经**包含在了通解中**，对应于$C_0=0$的情况。

* 再解普通线性方程（12），采用“==常数变易法==”，假设（12）的解具有形式
  $$
  y=C(x) e^{-\int P(x)dx}
  \tag{15}
  $$
  即将待定常数$C$变为待定函数$C(x)$。再将解（15）带回方程（12），可以解出
  $$
  C(x)=\int Q(x)e^{-\int P(x)dx}dx+C_1
  \tag{16}
  $$
  从而得到（12）的通解为
  $$
  y=e^{-\int P(x)dx}(\int Q(x)e^{-\int P(x)dx}dx+C_1
  \tag{17})
  $$

* 可以发现，当$C_1=0$（或其他数值）时，（17）是方程（12）的一个特解。而$y=C_1 e^{-\int P(x)dx}$是（13）的通解。故而一阶线性方程解的结构为：**相应齐次方程的通解加上非齐次方程的一个特解**。

* **可化为一阶线性方程的方程**：

  形如
  $$
  f'(y)\frac{dy}{dx}+P(x)f(y)=Q(x)
  \tag{18}
  $$
  做函数变换$z=f(y)$，$\frac{dz}{dx}=f'(y)\frac{dy}{dx}$，可以化为$z$的线性方程
  $$
  \frac{dz}{dx}+P(x)z=Q(x)
  \tag{19}
  $$

  * ==伯努利方程==

  $$
  \frac{dy}{dx}+p(x)y=q(x)y^n
  \tag{20}
  $$

  可做变换$z=y^{1-n}$

#### $\S$2.3 全微分方程

* 如果微分方程
  $$
  P(x,y)dx+Q(x,y)dy=0
  \tag{21}
  $$
  满足$\frac{\partial Q}{\partial x}=\frac{\partial P}{\partial y}$，那么（21）等号左边恰好是某个二元函数$u(x,y)$的全微分，即
  $$
  du(x,y)=P(x,y)dx+Q(x,y)dy
  \tag{22}
  $$
  那么（21）为**全微分方程**，原函数可以写为
  $$
  u=\int _{(x_0,y_0)}^{(x,y)}Pdx+Qdy
  \tag{23}
  $$
  积分路径可以表示为：$(x_0,y_0) \rightarrow (x,y_0)/(x_0,y) \rightarrow (x,y)$，则（21）的通解可以表示为
  $$
  u(x,y)=C
  \tag{24}
  $$

* **积分因子**
  若（21）不是全微分方程，但是将方程乘上一个因子$\mu(x,y)$之后能使方程变为全微分方程，那么就称$\mu(x,y)$为方程（21）的一个**积分因子**。
  由全微分方程的定义可以知道，积分因子需要满足的充要条件是
  $$
  \frac{\partial}{\partial x}(\mu Q)=\frac{\partial}{\partial y}(\mu P)
  \tag{25}
  $$
  经过适当变形，可以得到：
  $$
  Q\frac{\partial \ln \mu}{\partial x}-P\frac{\partial \ln \mu}{\partial y}=\frac{\partial P}{\partial y}-\frac{\partial Q}{\partial x}
  \tag{26}
  $$

  * 例子：
    $$
    ydx-xdy=0
    \tag{27}
    $$
    容易验证出该方程有这些积分因子，如

    1. $\mu=\frac{1}{x^2}$，则有$\frac{ydx-xdy}{x^2}=d(-\frac{y}{x})$；
    2. $\mu = \frac{1}{xy}$，则有$\frac{ydx-xdy}{xy}=d(\ln \frac{x}{y})$；
    3. $\mu=\frac{1}{x^2+y^2}$，则有$\frac{ydx-xdy}{x^2+y^2}=d(\arctan \frac{x}{y})$；

    等等，可见一个方程的积分因子不是唯一的。

  * 对于特殊形式的积分因子，以$\mu=\mu(x),\frac{\partial \mu}{\partial y}=0$为例：

    则（26）可以化为
    $$
    \frac{\partial \ln \mu}{\partial x}=\frac{\frac{\partial P}{\partial y}-\frac{\partial Q}{\partial x}}{Q}
    \tag{28}
    $$
    若等式右边能满足$\phi(x) = \frac{1}{Q}(\frac{\partial P}{\partial y}-\frac{\partial Q}{\partial x})$，那么存在积分因子
    $$
    \mu(x)=e^{\int \phi(x)dx}
    \tag{29}
    $$

#### $\S$2.4 二阶常微分方程

* 不显含未知函数$y$的二阶方程$y''=f(x,y')$
  可以作变换：==$y'=p,y''=p'$==，就可以把方程转变为关于$p(x)$的一阶线性方程。

* 不显含自变量$x$的二阶方程$y''=f(y,y')$
  同样作变换：==$y'=p,y''=\frac{dp}{dx}=\frac{dp}{dy}\frac{dy}{dx}=p\frac{dp}{dy}$==，就可以把方程转变为关于$p(y)$的一阶线性方程。

* 二阶常系数线性方程
  $$
  y''+py'+qy=f(x)
  \tag{30}
  $$
  称为**二阶常系数线性非齐次方程**。如果$f(x)\equiv 0$，那么
  $$
  y''+y'p+qy=0
  \tag{31}
  $$
  为**二阶常系数线性齐次方程**。

* 通解的结构

  * **定理1** 如果$y_1(x),y_2(x)$分别是微分方程$y''+py'+qy=f_1(x)$与$y''+py'+qy=f_2(x)$的解，那么$\alpha y_1(x)+\beta y_2(x)$是微分方程$y''+py'+qy=\alpha f_1(x)+\beta f_2(x)$的解，其中$\alpha,\beta$均是常数。
  * **定理2** 如果$y_1(x)$与$y_2(x)$是（31）的两个特解，且它们是线性无关的，那么$y=c_1y_1+c_2y_2$是（31）的通解，其中$c_1,c_2$是任意常数。
  * **定理3**（通解结构） 如果$Y$是（30）的一个特解，而$\overline y=c_1y_1+c_2y_2$是相应的齐次方程（31）的通解，那么（30）的通解为$y=Y+\overline y$。
    也就是说，**线性非齐次方程的通解等于它的一个特解加上其相应齐次方程的通解**。
  * **定理4** 对于定理1，若$\beta$取虚数$i$，定理同样满足。

* 先解**齐次方程**（31）的通解
  设试探解为==$y=e^{\lambda x}$==，代入方程后，得到$\lambda$满足的代数方程
  $$
  \lambda^2+p\lambda+q=0
  \tag{32}
  $$
  （32）为（31）的**特征方程**，它的根称为**特征根**。下面进行分类讨论：

  1. $p^2-4q>0$，方程有两个不相同的实根$\lambda_1,\lambda_2$，从而通解为
     $$
     y=C_1e^{\lambda_1x}+C_2e^{\lambda_2x}
     \tag{33}
     $$

  2. $p^2-4q=0$，方程有两个相等实根$\lambda=-p/2$，再利用常数变易法，可以得通解
     $$
     y=e^{\lambda x}(C_1x+C_2)
     \tag{34}
     $$

  3. $p^2-4q<0$，方程有两个不同的共轭复数解$\alpha+i\beta$，再利用**欧拉公式$e^{i\theta}=\cos \theta +i\sin \theta$**，可以得通解
     $$
     y=e^{\alpha x}(C_1 \cos \beta x+C_2 \sin \beta x)
     \tag{35}
     $$

* 再解**非齐次方程**（30）
  常数变易法不再过多阐述，只需要把齐次方程通解中的待定常数$C_1,C_2$变为待定函数，再代入非齐次方程即可。
  下面用**待定系数法**求解通解：
  考虑方程
  $$
  y''+py'+qy=P_m(x)e^{rx}
  \tag{36}
  $$
  其中$p,q$为常数，$P_m(x)$为$m$次多项式，$r$为实或复常数。可以设试探解为$Q(x)e^{rx}$，代入方程式，得到
  $$
  Q''+(2r+p)Q'+(r^2+pr+q)Q=P_m
  \tag{37}
  $$
  同样可以分三种情况讨论：

  1. 若$r^2+pr+q \neq 0$，即$r$不是特征根，那么特解形式为
     $$
     Y=Q_m(x)e^{rx}
     \tag{38}
     $$

  2. 若$r^2+pr+q = 0,2r+p \neq 0$，即$r$是特征根的单根，那么特解形式为
     $$
     Y=xQ_m(x)e^{rx}
     \tag{39}
     $$

  3. 若$r^2+pr+q = 0,2r+p = 0$，即$r$是特征根的二重根，那么特解形式为
     $$
     Y=x^2Q_m(x)e^{rx}
     \tag{40}
     $$

  上述讨论其实就是为了**确认$Q(x)$这个多项式的次数**，是通过（37）等式两边的次数来判断的。例如第3个情况下，等式左边是$Q$的二阶导，那么只有让通解含有$x^2$这个因子，才能使这个二阶导的次数仍然为$m$。

* **欧拉方程**
  $$
  x^2y''+p_1xy'+p_2y=f(x)
  \tag{41}
  $$
  作变换$x=e^t(x>0)$或$x=-e^t(x<0)$，并设$D=\frac{d}{dt},D^2=\frac{d^2}{dt^2}$，则得到一个常系数线性二阶微分方程。
  $$
  [D^2+(p_1-1)D+p_2]y=f(\varepsilon e^t)
  \tag{42}
  $$
  其中$\varepsilon=1$对应于$x>0$的情况；$\varepsilon=-1$对应于$x<0$的情况。
  *一定要区分好$y$的导数是对$x$的还是对$t$的。*
  
  